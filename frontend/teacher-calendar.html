<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teacher Availability - Dostepnosc nauczyciela</title>
    <link rel="stylesheet" href="css/style.css?v=4">
</head>
<body>
    <div class="container">
        <nav class="site-nav">
            <a href="student_dashboard.html" class="nav-brand">IntakeEval</a>
            <div class="nav-links">
                <a href="student_dashboard.html">Dashboard</a>
                <a href="teacher-calendar.html" class="active">Teacher Availability</a>
                <a href="assessment.html">Assessment</a>
                <a href="games.html">Games</a>
            </div>
        </nav>

        <div class="dashboard-header">
            <div>
                <h1>Teacher Availability</h1>
                <p class="subtitle">Dostepnosc nauczyciela / View when teachers are available</p>
            </div>
            <a href="student_dashboard.html" class="btn btn-sm">&larr; Back to Dashboard</a>
        </div>

        <!-- Teacher Selection -->
        <div class="form-section" id="teacher-select-section">
            <h2>Select Teacher / Wybierz nauczyciela</h2>
            <div class="form-group">
                <select id="teacher-select" onchange="onTeacherChange()">
                    <option value="">Loading teachers... / Ladowanie...</option>
                </select>
            </div>
        </div>

        <!-- Calendar Section -->
        <div class="form-section" id="calendar-section">
            <div class="calendar-header">
                <button class="btn btn-sm" onclick="prevMonth()" id="prev-month-btn">&larr; Prev</button>
                <h2 id="calendar-month-title">February 2026</h2>
                <button class="btn btn-sm" onclick="nextMonth()" id="next-month-btn">Next &rarr;</button>
            </div>

            <div class="calendar-legend">
                <span class="legend-item"><span class="legend-dot legend-available"></span> Available / Dostepny</span>
                <span class="legend-item"><span class="legend-dot legend-unavailable"></span> Unavailable / Niedostepny</span>
                <span class="legend-item"><span class="legend-dot legend-no-hours"></span> No hours set / Brak godzin</span>
                <span class="legend-item"><span class="legend-dot" style="background:#fbbf24;"></span> Requested / Oczekujaca</span>
                <span class="legend-item"><span class="legend-dot" style="background:#34d399;"></span> Confirmed / Potwierdzona</span>
            </div>

            <div id="calendar-grid" class="calendar-grid">
                <!-- Calendar will be rendered by JS -->
            </div>

            <div id="calendar-loading" class="calendar-loading hidden">
                <div class="loading">Loading availability... / Ladowanie dostepnosci...</div>
            </div>

            <div id="calendar-error" class="calendar-error hidden">
                <p>Could not load availability. Please try again.</p>
            </div>
        </div>

        <!-- Selected Day Details -->
        <div class="form-section" id="day-details-section">
            <h2 id="day-details-title">Select a Day / Wybierz dzien</h2>
            <div id="day-details-content">
                <p class="meta">Click on a day in the calendar above to see available time slots.</p>
                <p class="meta"><em>Kliknij dzien w kalendarzu powyzej, aby zobaczyc dostepne godziny.</em></p>
            </div>
        </div>

        <!-- Quick Book CTA -->
        <div class="form-section" id="book-cta-section" style="display:none;">
            <div class="book-cta">
                <div class="book-cta-text">
                    <strong>Request a session / Popros o sesje</strong>
                    <p>Pick a time and duration, then submit your request.</p>
                    <p><em>Wybierz godzine i czas trwania, a nastepnie wyslij prosbe.</em></p>
                </div>
                <div class="book-cta-form" style="display:flex;gap:0.75rem;align-items:flex-end;flex-wrap:wrap;">
                    <div class="form-group" style="margin:0;">
                        <label for="session-time" style="font-size:0.75rem;color:#94a3b8;">Time / Godzina</label>
                        <input type="time" id="session-time" value="10:00" style="padding:0.4rem 0.5rem;border-radius:6px;border:1px solid rgba(148,163,184,0.2);background:rgba(15,23,42,0.6);color:#e2e8f0;">
                    </div>
                    <div class="form-group" style="margin:0;">
                        <label for="session-duration" style="font-size:0.75rem;color:#94a3b8;">Duration / Czas</label>
                        <select id="session-duration" style="padding:0.4rem 0.5rem;border-radius:6px;border:1px solid rgba(148,163,184,0.2);background:rgba(15,23,42,0.6);color:#e2e8f0;">
                            <option value="30">30 min</option>
                            <option value="45">45 min</option>
                            <option value="60" selected>60 min</option>
                            <option value="90">90 min</option>
                        </select>
                    </div>
                    <button class="btn btn-primary" onclick="submitCalendarRequest()">Request / Wyslij</button>
                </div>
                <div id="book-cta-status" style="margin-top:0.5rem;font-size:0.8rem;"></div>
            </div>
        </div>

        <footer>
            <a href="student_dashboard.html">Dashboard / Panel</a> &middot;
            <a href="assessment.html">Assessment / Test</a> &middot;
            <a href="games.html">Games / Gry</a>
        </footer>
    </div>

    <script src="js/api.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/state.js"></script>
    <script src="js/nav.js"></script>
    <script src="js/app.js"></script>
    <script src="js/teacher-calendar.js"></script>
    <script>
        // Role guard: only students allowed
        APP.guardRole(['student'], 'dashboard.html');
        AUTH.addAuthLinks && AUTH.addAuthLinks();
        AUTH.updateNav && AUTH.updateNav();
    </script>
</body>
</html>
